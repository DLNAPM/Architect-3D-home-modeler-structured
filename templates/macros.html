{% macro render_card(r, options, user) %}
<div class="render-card" data-id="{{ r['id'] }}">
    {% if user %}<input type="checkbox" name="rendering_id" class="rendering-checkbox">{% endif %}
    <img src="{{ url_for('static', filename=r['image_path']) }}" alt="{{ r['subcategory'] }}" class="render-img modal-trigger">
    <div class="meta">
        <span class="tag">{{ r['subcategory'] }}</span>
        <div class="actions">
            <button class="action-btn like-btn {% if r['liked'] %}active{% endif %}" title="Like">‚ù§Ô∏è</button>
            <button class="action-btn fav-btn {% if r['favorited'] %}active{% endif %}" title="Favorite">‚≠ê</button>
            <button class="action-btn dark-toggle" title="Toggle Dark Mode">üåô</button>
        </div>
    </div>
    <div class="modify-section">
        <details>
            <summary>Modify This Rendering</summary>
            <form class="modify-form" data-id="{{ r['id'] }}">
                <textarea name="description" rows="2" placeholder="Describe changes... e.g., 'make the siding dark blue'"></textarea>
                {% if options[r['subcategory']] %}
                <div class="options-grid">
                  {% for opt, vals in options[r['subcategory']].items() %}
                  <label>{{ opt }}
                    <select name="{{ opt }}">
                      {% set current_val = r['options_dict'].get(opt) %}
                      <option value="">-- Default --</option>
                      {% for v in vals %}<option value="{{ v }}" {% if v == current_val %}selected{% endif %}>{{ v }}</option>{% endfor %}
                    </select>
                  </label>
                  {% endfor %}
                </div>
                {% endif %}
                <button type="submit" class="button">Regenerate</button>
            </form>
        </details>
    </div>
</div>
{% endmacro %}
